title: K6 load testing
description: |-
  This is an experiment you can use for testing purposes to explore load testing in Chaostoolkit.
  The method will start the load testing script.

configuration:
  endpoint: 
    type: env
    key: COMMENTS_URL
    default: "http://localhost:3000"
  stress_duration: "10s"
  stress_users: "2"
  script_file: "journey_crud.js"

steady-state-hypothesis:
  title: "Verify web server is available"
  probes:
    - type: probe
      name: "server-must-respond-200"
      tolerance: 200
      provider:
        type: http
        url: "${endpoint}"
        method: "GET"
        timeout: 3

method:
  - type: action
    name: run-script
    provider:
      func: run_script
      module: chaosk6.actions
      type: python
      arguments:
        script_path: ${script_file}
        vus: ${stress_users}
        duration: ${stress_duration}
